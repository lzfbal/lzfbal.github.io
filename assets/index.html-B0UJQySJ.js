import{_ as n,c as r,d as s,b as l,a as t,r as o,o as i}from"./app-zMw5onuM.js";const e={};function c(p,a){const m=o("Mermaid");return i(),r("div",null,[a[0]||(a[0]=s("h2",{id:"scram",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#scram"},[s("span",null,"SCRAM")])],-1)),l(m,{code:"eJx1izsOgCAMQHdO0Qt4AQYWjJsTJ2hIQ5ogwRY9v5owKInr+yjtB5VIM2MS3ExFaRy5YmngARV8Zirtw8PDA8lJYvzkXLC9goVFG6ykiolMuJ23vRzc+BXMv9/bXR43O28="}),a[1]||(a[1]=t('<h2 id="detailed-steps-and-data-structures" tabindex="-1"><a class="header-anchor" href="#detailed-steps-and-data-structures"><span>Detailed Steps and Data Structures</span></a></h2><table><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#C3B1E1"><mrow><mi>S</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>P</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\\color{#C3B1E1}{SaltedPassword}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord" style="color:#C3B1E1;"><span class="mord mathnormal" style="margin-right:0.05764em;color:#C3B1E1;">S</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">lt</span><span class="mord mathnormal" style="color:#C3B1E1;">e</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span><span class="mord mathnormal" style="margin-right:0.13889em;color:#C3B1E1;">P</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">ss</span><span class="mord mathnormal" style="margin-right:0.02691em;color:#C3B1E1;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#C3B1E1;">or</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span></span></span></span></span></td><td>Password after PBKDF2 processing</td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#B8CC44"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\\color{#B8CC44}{ClientKey}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#B8CC44;"><span class="mord mathnormal" style="margin-right:0.01968em;color:#B8CC44;">Cl</span><span class="mord mathnormal" style="color:#B8CC44;">i</span><span class="mord mathnormal" style="color:#B8CC44;">e</span><span class="mord mathnormal" style="color:#B8CC44;">n</span><span class="mord mathnormal" style="color:#B8CC44;">t</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#B8CC44;">Key</span></span></span></span></span></td><td>Key derived from SaltedPassword for client</td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#EE6666"><mrow><mi>S</mi><mi>t</mi><mi>o</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\\color{#EE6666}{StoredKey}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#EE6666;"><span class="mord mathnormal" style="color:#EE6666;">St</span><span class="mord mathnormal" style="color:#EE6666;">ore</span><span class="mord mathnormal" style="color:#EE6666;">d</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#EE6666;">Key</span></span></span></span></span></td><td>Hashed ClientKey stored on server</td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="orange"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>S</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\\color{orange}{ClientSignature}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:orange;"><span class="mord mathnormal" style="margin-right:0.01968em;color:orange;">Cl</span><span class="mord mathnormal" style="color:orange;">i</span><span class="mord mathnormal" style="color:orange;">e</span><span class="mord mathnormal" style="color:orange;">n</span><span class="mord mathnormal" style="margin-right:0.05764em;color:orange;">tS</span><span class="mord mathnormal" style="color:orange;">i</span><span class="mord mathnormal" style="margin-right:0.03588em;color:orange;">g</span><span class="mord mathnormal" style="color:orange;">na</span><span class="mord mathnormal" style="color:orange;">t</span><span class="mord mathnormal" style="color:orange;">u</span><span class="mord mathnormal" style="color:orange;">re</span></span></span></span></span></td><td>HMAC of StoredKey and AuthMessage</td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#935116"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>P</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>f</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\\color{#935116}{ClientProof}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#935116;"><span class="mord mathnormal" style="margin-right:0.01968em;color:#935116;">Cl</span><span class="mord mathnormal" style="color:#935116;">i</span><span class="mord mathnormal" style="color:#935116;">e</span><span class="mord mathnormal" style="color:#935116;">n</span><span class="mord mathnormal" style="margin-right:0.13889em;color:#935116;">tP</span><span class="mord mathnormal" style="color:#935116;">roo</span><span class="mord mathnormal" style="margin-right:0.10764em;color:#935116;">f</span></span></span></span></span></td><td>XOR of ClientKey and ClientSignature</td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mrow><mi>A</mi><mi>u</mi><mi>t</mi><mi>h</mi><mi>M</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\\color{green}{AuthMessage}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:green;"><span class="mord mathnormal" style="color:green;">A</span><span class="mord mathnormal" style="color:green;">u</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">h</span><span class="mord mathnormal" style="margin-right:0.10903em;color:green;">M</span><span class="mord mathnormal" style="color:green;">ess</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">g</span><span class="mord mathnormal" style="color:green;">e</span></span></span></span></span></td><td>Concatenated authentication messages</td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mrow><mi>S</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\\color{cyan}{ServerKey}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord" style="color:cyan;"><span class="mord mathnormal" style="margin-right:0.05764em;color:cyan;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;color:cyan;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;color:cyan;">v</span><span class="mord mathnormal" style="margin-right:0.03588em;color:cyan;">erKey</span></span></span></span></span></td><td>Key derived from SaltedPassword for server</td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#DD6F3D"><mrow><mi>S</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>S</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\\color{#DD6F3D}{ServerSignature}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#DD6F3D;"><span class="mord mathnormal" style="margin-right:0.05764em;color:#DD6F3D;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#DD6F3D;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#DD6F3D;">v</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#DD6F3D;">er</span><span class="mord mathnormal" style="margin-right:0.05764em;color:#DD6F3D;">S</span><span class="mord mathnormal" style="color:#DD6F3D;">i</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#DD6F3D;">g</span><span class="mord mathnormal" style="color:#DD6F3D;">na</span><span class="mord mathnormal" style="color:#DD6F3D;">t</span><span class="mord mathnormal" style="color:#DD6F3D;">u</span><span class="mord mathnormal" style="color:#DD6F3D;">re</span></span></span></span></span></td><td>Final server verification value</td></tr></tbody></table><p>Key Operations:</p><table><thead><tr><th>Operation</th><th>Description</th></tr></thead><tbody><tr><td>PBKDF2</td><td>Password-Based Key Derivation Function</td></tr><tr><td>HMAC</td><td>Hash-based Message Authentication Code</td></tr><tr><td>Hash</td><td>One-way hash function</td></tr><tr><td>XOR</td><td>Exclusive OR operation</td></tr></tbody></table><h2 id="detail-process" tabindex="-1"><a class="header-anchor" href="#detail-process"><span>Detail process</span></a></h2><h3 id="_1-client-first-message" tabindex="-1"><a class="header-anchor" href="#_1-client-first-message"><span>1. Client First Message</span></a></h3><table><thead><tr><th>Field</th><th>Dscription</th></tr></thead><tbody><tr><td>username</td><td>user id</td></tr><tr><td>nonce</td><td>Client random string</td></tr></tbody></table><h3 id="_2-server-first-message" tabindex="-1"><a class="header-anchor" href="#_2-server-first-message"><span>2. Server First Message</span></a></h3><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>salt</td><td>Stored password salt</td></tr><tr><td>server-nonce</td><td>Server nonce (including client nonce)</td></tr><tr><td>iteration-count</td><td>PBKDF2 iteration count</td></tr></tbody></table><h3 id="_3-client-final-message" tabindex="-1"><a class="header-anchor" href="#_3-client-final-message"><span>3. Client Final Message</span></a></h3><ul><li><p>Client calculates SaltedPassword using received salt and iteration-count</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#C3B1E1"><mrow><mi>S</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>P</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>P</mi><mi>B</mi><mi>K</mi><mi>D</mi><mi>F</mi><mn>2</mn><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi><mo separator="true">,</mo><mi>s</mi><mi>a</mi><mi>l</mi><mi>t</mi><mo separator="true">,</mo><mi>i</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mtext>-</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">)</mo></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{#C3B1E1}{SaltedPassword} \\color{inherit}= PBKDF2(password, salt, iteration\\text{-}count)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord" style="color:#C3B1E1;"><span class="mord mathnormal" style="margin-right:0.05764em;color:#C3B1E1;">S</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">lt</span><span class="mord mathnormal" style="color:#C3B1E1;">e</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span><span class="mord mathnormal" style="margin-right:0.13889em;color:#C3B1E1;">P</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">ss</span><span class="mord mathnormal" style="margin-right:0.02691em;color:#C3B1E1;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#C3B1E1;">or</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;color:inherit;">PB</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">KD</span><span class="mord mathnormal" style="margin-right:0.13889em;color:inherit;">F</span><span class="mord" style="color:inherit;">2</span><span class="mopen" style="color:inherit;">(</span><span class="mord mathnormal" style="color:inherit;">p</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="color:inherit;">ss</span><span class="mord mathnormal" style="margin-right:0.02691em;color:inherit;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">or</span><span class="mord mathnormal" style="color:inherit;">d</span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="color:inherit;">s</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="color:inherit;">lt</span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">er</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">o</span><span class="mord mathnormal" style="color:inherit;">n</span><span class="mord text" style="color:inherit;"><span class="mord" style="color:inherit;">-</span></span><span class="mord mathnormal" style="color:inherit;">co</span><span class="mord mathnormal" style="color:inherit;">u</span><span class="mord mathnormal" style="color:inherit;">n</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mclose" style="color:inherit;">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#B8CC44"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>H</mi><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy="false">(</mo><mstyle mathcolor="#C3B1E1"><mrow><mi>S</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>P</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi></mrow><mstyle mathcolor="inherit"><mo separator="true">,</mo><mi mathvariant="normal">&quot;</mi><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mtext> </mtext><mi>K</mi><mi>e</mi><mi>y</mi><mi mathvariant="normal">&quot;</mi><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{#B8CC44}{ClientKey} \\color{inherit} = HMAC(\\color{#C3B1E1}{SaltedPassword}\\color{inherit}, &quot;Client\\ Key&quot;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#B8CC44;"><span class="mord mathnormal" style="margin-right:0.01968em;color:#B8CC44;">Cl</span><span class="mord mathnormal" style="color:#B8CC44;">i</span><span class="mord mathnormal" style="color:#B8CC44;">e</span><span class="mord mathnormal" style="color:#B8CC44;">n</span><span class="mord mathnormal" style="color:#B8CC44;">t</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#B8CC44;">Key</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;color:inherit;">H</span><span class="mord mathnormal" style="margin-right:0.10903em;color:inherit;">M</span><span class="mord mathnormal" style="color:inherit;">A</span><span class="mord mathnormal" style="margin-right:0.07153em;color:inherit;">C</span><span class="mopen" style="color:inherit;">(</span><span class="mord" style="color:#C3B1E1;"><span class="mord mathnormal" style="margin-right:0.05764em;color:#C3B1E1;">S</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">lt</span><span class="mord mathnormal" style="color:#C3B1E1;">e</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span><span class="mord mathnormal" style="margin-right:0.13889em;color:#C3B1E1;">P</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">ss</span><span class="mord mathnormal" style="margin-right:0.02691em;color:#C3B1E1;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#C3B1E1;">or</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span></span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:inherit;">&quot;</span><span class="mord mathnormal" style="margin-right:0.01968em;color:inherit;">Cl</span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">e</span><span class="mord mathnormal" style="color:inherit;">n</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mspace" style="color:inherit;"><span style="color:inherit;"> </span></span><span class="mord mathnormal" style="margin-right:0.03588em;color:inherit;">Key</span><span class="mord" style="color:inherit;">&quot;</span><span class="mclose" style="color:inherit;">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#EE6666"><mrow><mi>S</mi><mi>t</mi><mi>o</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mstyle mathcolor="#B8CC44"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{#EE6666}{StoredKey}\\color{inherit} = Hash(\\color{#B8CC44}{ClientKey}\\color{inherit})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#EE6666;"><span class="mord mathnormal" style="color:#EE6666;">St</span><span class="mord mathnormal" style="color:#EE6666;">ore</span><span class="mord mathnormal" style="color:#EE6666;">d</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#EE6666;">Key</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;color:inherit;">H</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="color:inherit;">s</span><span class="mord mathnormal" style="color:inherit;">h</span><span class="mopen" style="color:inherit;">(</span><span class="mord" style="color:#B8CC44;"><span class="mord mathnormal" style="margin-right:0.01968em;color:#B8CC44;">Cl</span><span class="mord mathnormal" style="color:#B8CC44;">i</span><span class="mord mathnormal" style="color:#B8CC44;">e</span><span class="mord mathnormal" style="color:#B8CC44;">n</span><span class="mord mathnormal" style="color:#B8CC44;">t</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#B8CC44;">Key</span></span><span class="mclose" style="color:inherit;">)</span></span></span></span></p></li><li><p>Calculates ClientSignature and ClientProof</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="orange"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>S</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>H</mi><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy="false">(</mo><mstyle mathcolor="#EE6666"><mrow><mi>S</mi><mi>t</mi><mi>o</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo separator="true">,</mo><mstyle mathcolor="green"><mrow><mi>A</mi><mi>u</mi><mi>t</mi><mi>h</mi><mi>M</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi></mrow><mstyle mathcolor="inherit"><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{orange}{ClientSignature}\\color{inherit} = HMAC(\\color{#EE6666}{StoredKey}\\color{inherit}, \\color{green}{AuthMessage}\\color{inherit})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:orange;"><span class="mord mathnormal" style="margin-right:0.01968em;color:orange;">Cl</span><span class="mord mathnormal" style="color:orange;">i</span><span class="mord mathnormal" style="color:orange;">e</span><span class="mord mathnormal" style="color:orange;">n</span><span class="mord mathnormal" style="margin-right:0.05764em;color:orange;">tS</span><span class="mord mathnormal" style="color:orange;">i</span><span class="mord mathnormal" style="margin-right:0.03588em;color:orange;">g</span><span class="mord mathnormal" style="color:orange;">na</span><span class="mord mathnormal" style="color:orange;">t</span><span class="mord mathnormal" style="color:orange;">u</span><span class="mord mathnormal" style="color:orange;">re</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;color:inherit;">H</span><span class="mord mathnormal" style="margin-right:0.10903em;color:inherit;">M</span><span class="mord mathnormal" style="color:inherit;">A</span><span class="mord mathnormal" style="margin-right:0.07153em;color:inherit;">C</span><span class="mopen" style="color:inherit;">(</span><span class="mord" style="color:#EE6666;"><span class="mord mathnormal" style="color:#EE6666;">St</span><span class="mord mathnormal" style="color:#EE6666;">ore</span><span class="mord mathnormal" style="color:#EE6666;">d</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#EE6666;">Key</span></span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:green;"><span class="mord mathnormal" style="color:green;">A</span><span class="mord mathnormal" style="color:green;">u</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">h</span><span class="mord mathnormal" style="margin-right:0.10903em;color:green;">M</span><span class="mord mathnormal" style="color:green;">ess</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">g</span><span class="mord mathnormal" style="color:green;">e</span></span><span class="mclose" style="color:inherit;">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#935116"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>P</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>f</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mstyle mathcolor="#B8CC44"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mtext>  </mtext><mstyle mathcolor="inherit"><mi>X</mi><mi>O</mi><mi>R</mi><mtext>  </mtext><mstyle mathcolor="orange"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>S</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></mstyle></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{#935116}{ClientProof}\\color{inherit} = \\color{#B8CC44}{ClientKey} \\ \\ \\color{inherit} XOR \\ \\ \\color{orange}{ClientSignature}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#935116;"><span class="mord mathnormal" style="margin-right:0.01968em;color:#935116;">Cl</span><span class="mord mathnormal" style="color:#935116;">i</span><span class="mord mathnormal" style="color:#935116;">e</span><span class="mord mathnormal" style="color:#935116;">n</span><span class="mord mathnormal" style="margin-right:0.13889em;color:#935116;">tP</span><span class="mord mathnormal" style="color:#935116;">roo</span><span class="mord mathnormal" style="margin-right:0.10764em;color:#935116;">f</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#B8CC44;"><span class="mord mathnormal" style="margin-right:0.01968em;color:#B8CC44;">Cl</span><span class="mord mathnormal" style="color:#B8CC44;">i</span><span class="mord mathnormal" style="color:#B8CC44;">e</span><span class="mord mathnormal" style="color:#B8CC44;">n</span><span class="mord mathnormal" style="color:#B8CC44;">t</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#B8CC44;">Key</span></span><span class="mspace" style="color:#B8CC44;"><span style="color:#B8CC44;"> </span></span><span class="mspace" style="color:#B8CC44;"><span style="color:#B8CC44;"> </span></span><span class="mord mathnormal" style="margin-right:0.00773em;color:inherit;">XOR</span><span class="mspace" style="color:inherit;"><span style="color:inherit;"> </span></span><span class="mspace" style="color:inherit;"><span style="color:inherit;"> </span></span><span class="mord" style="color:orange;"><span class="mord mathnormal" style="margin-right:0.01968em;color:orange;">Cl</span><span class="mord mathnormal" style="color:orange;">i</span><span class="mord mathnormal" style="color:orange;">e</span><span class="mord mathnormal" style="color:orange;">n</span><span class="mord mathnormal" style="margin-right:0.05764em;color:orange;">tS</span><span class="mord mathnormal" style="color:orange;">i</span><span class="mord mathnormal" style="margin-right:0.03588em;color:orange;">g</span><span class="mord mathnormal" style="color:orange;">na</span><span class="mord mathnormal" style="color:orange;">t</span><span class="mord mathnormal" style="color:orange;">u</span><span class="mord mathnormal" style="color:orange;">re</span></span></span></span></span></p><p>Where</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mrow><mi>A</mi><mi>u</mi><mi>t</mi><mi>h</mi><mi>M</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mtext>-</mtext><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mtext>-</mtext><mi>b</mi><mi>a</mi><mi>r</mi><mi>e</mi><mo>+</mo><mi mathvariant="normal">&quot;</mi><mo separator="true">,</mo><mi mathvariant="normal">&quot;</mi><mo>+</mo><mi>s</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mtext>-</mtext><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mtext>-</mtext><mi>m</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo>+</mo><mi mathvariant="normal">&quot;</mi><mo separator="true">,</mo><mi mathvariant="normal">&quot;</mi><mo>+</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mtext>-</mtext><mi>f</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi><mtext>-</mtext><mi>w</mi><mi>i</mi><mi>t</mi><mi>h</mi><mi>o</mi><mi>u</mi><mi>t</mi><mtext>-</mtext><mi>p</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>f</mi></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{green}{AuthMessage}\\color{inherit} = client\\text{-}first\\text{-}bare+&quot;,&quot;+server\\text{-}first\\text{-}message+&quot;,&quot;+client\\text{-}final\\text{-}without\\text{-}proof</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:green;"><span class="mord mathnormal" style="color:green;">A</span><span class="mord mathnormal" style="color:green;">u</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">h</span><span class="mord mathnormal" style="margin-right:0.10903em;color:green;">M</span><span class="mord mathnormal" style="color:green;">ess</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">g</span><span class="mord mathnormal" style="color:green;">e</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="color:inherit;">c</span><span class="mord mathnormal" style="margin-right:0.01968em;color:inherit;">l</span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">e</span><span class="mord mathnormal" style="color:inherit;">n</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mord text" style="color:inherit;"><span class="mord" style="color:inherit;">-</span></span><span class="mord mathnormal" style="margin-right:0.10764em;color:inherit;">f</span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">rs</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mord text" style="color:inherit;"><span class="mord" style="color:inherit;">-</span></span><span class="mord mathnormal" style="color:inherit;">ba</span><span class="mord mathnormal" style="color:inherit;">re</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:inherit;">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:inherit;">&quot;</span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:inherit;">&quot;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:inherit;">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">ser</span><span class="mord mathnormal" style="margin-right:0.03588em;color:inherit;">v</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">er</span><span class="mord text" style="color:inherit;"><span class="mord" style="color:inherit;">-</span></span><span class="mord mathnormal" style="margin-right:0.10764em;color:inherit;">f</span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">rs</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mord text" style="color:inherit;"><span class="mord" style="color:inherit;">-</span></span><span class="mord mathnormal" style="color:inherit;">m</span><span class="mord mathnormal" style="color:inherit;">ess</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="margin-right:0.03588em;color:inherit;">g</span><span class="mord mathnormal" style="color:inherit;">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:inherit;">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:inherit;">&quot;</span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:inherit;">&quot;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:inherit;">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="color:inherit;">c</span><span class="mord mathnormal" style="margin-right:0.01968em;color:inherit;">l</span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">e</span><span class="mord mathnormal" style="color:inherit;">n</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mord text" style="color:inherit;"><span class="mord" style="color:inherit;">-</span></span><span class="mord mathnormal" style="margin-right:0.10764em;color:inherit;">f</span><span class="mord mathnormal" style="color:inherit;">ina</span><span class="mord mathnormal" style="margin-right:0.01968em;color:inherit;">l</span><span class="mord text" style="color:inherit;"><span class="mord" style="color:inherit;">-</span></span><span class="mord mathnormal" style="margin-right:0.02691em;color:inherit;">w</span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mord mathnormal" style="color:inherit;">h</span><span class="mord mathnormal" style="color:inherit;">o</span><span class="mord mathnormal" style="color:inherit;">u</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mord text" style="color:inherit;"><span class="mord" style="color:inherit;">-</span></span><span class="mord mathnormal" style="color:inherit;">p</span><span class="mord mathnormal" style="color:inherit;">roo</span><span class="mord mathnormal" style="margin-right:0.10764em;color:inherit;">f</span></span></span></span></p></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>channel-binding</td><td>Channel binding info</td></tr><tr><td>nonce</td><td>Complete nonce value</td></tr><tr><td>proof</td><td>Client proof</td></tr></tbody></table><h3 id="_4-server-final-message" tabindex="-1"><a class="header-anchor" href="#_4-server-final-message"><span>4. Server Final Message</span></a></h3><ul><li><p>Server verifies ClientProof Verification process:</p><p>The server first repeats the client&#39;s calculation process using stored user information:</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#C3B1E1"><mrow><mi>S</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>P</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>P</mi><mi>B</mi><mi>K</mi><mi>D</mi><mi>F</mi><mn>2</mn><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi><mo separator="true">,</mo><mi>s</mi><mi>a</mi><mi>l</mi><mi>t</mi><mo separator="true">,</mo><mi>i</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mtext>-</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">)</mo></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{#C3B1E1}{SaltedPassword}\\color{inherit} = PBKDF2(password, salt, iteration\\text{-}count)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord" style="color:#C3B1E1;"><span class="mord mathnormal" style="margin-right:0.05764em;color:#C3B1E1;">S</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">lt</span><span class="mord mathnormal" style="color:#C3B1E1;">e</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span><span class="mord mathnormal" style="margin-right:0.13889em;color:#C3B1E1;">P</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">ss</span><span class="mord mathnormal" style="margin-right:0.02691em;color:#C3B1E1;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#C3B1E1;">or</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;color:inherit;">PB</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">KD</span><span class="mord mathnormal" style="margin-right:0.13889em;color:inherit;">F</span><span class="mord" style="color:inherit;">2</span><span class="mopen" style="color:inherit;">(</span><span class="mord mathnormal" style="color:inherit;">p</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="color:inherit;">ss</span><span class="mord mathnormal" style="margin-right:0.02691em;color:inherit;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">or</span><span class="mord mathnormal" style="color:inherit;">d</span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="color:inherit;">s</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="color:inherit;">lt</span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">er</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">o</span><span class="mord mathnormal" style="color:inherit;">n</span><span class="mord text" style="color:inherit;"><span class="mord" style="color:inherit;">-</span></span><span class="mord mathnormal" style="color:inherit;">co</span><span class="mord mathnormal" style="color:inherit;">u</span><span class="mord mathnormal" style="color:inherit;">n</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mclose" style="color:inherit;">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#B8CC44"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>H</mi><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy="false">(</mo><mstyle mathcolor="#C3B1E1"><mrow><mi>S</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>P</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi></mrow><mstyle mathcolor="inherit"><mo separator="true">,</mo><mi mathvariant="normal">&quot;</mi><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mtext> </mtext><mi>K</mi><mi>e</mi><mi>y</mi><mi mathvariant="normal">&quot;</mi><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{#B8CC44}{ClientKey}\\color{inherit} = HMAC(\\color{#C3B1E1}{SaltedPassword}\\color{inherit}, &quot;Client\\ Key&quot;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#B8CC44;"><span class="mord mathnormal" style="margin-right:0.01968em;color:#B8CC44;">Cl</span><span class="mord mathnormal" style="color:#B8CC44;">i</span><span class="mord mathnormal" style="color:#B8CC44;">e</span><span class="mord mathnormal" style="color:#B8CC44;">n</span><span class="mord mathnormal" style="color:#B8CC44;">t</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#B8CC44;">Key</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;color:inherit;">H</span><span class="mord mathnormal" style="margin-right:0.10903em;color:inherit;">M</span><span class="mord mathnormal" style="color:inherit;">A</span><span class="mord mathnormal" style="margin-right:0.07153em;color:inherit;">C</span><span class="mopen" style="color:inherit;">(</span><span class="mord" style="color:#C3B1E1;"><span class="mord mathnormal" style="margin-right:0.05764em;color:#C3B1E1;">S</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">lt</span><span class="mord mathnormal" style="color:#C3B1E1;">e</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span><span class="mord mathnormal" style="margin-right:0.13889em;color:#C3B1E1;">P</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">ss</span><span class="mord mathnormal" style="margin-right:0.02691em;color:#C3B1E1;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#C3B1E1;">or</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span></span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:inherit;">&quot;</span><span class="mord mathnormal" style="margin-right:0.01968em;color:inherit;">Cl</span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">e</span><span class="mord mathnormal" style="color:inherit;">n</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mspace" style="color:inherit;"><span style="color:inherit;"> </span></span><span class="mord mathnormal" style="margin-right:0.03588em;color:inherit;">Key</span><span class="mord" style="color:inherit;">&quot;</span><span class="mclose" style="color:inherit;">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#EE6666"><mrow><mi>S</mi><mi>t</mi><mi>o</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mstyle mathcolor="#B8CC44"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{#EE6666}{StoredKey}\\color{inherit} = Hash(\\color{#B8CC44}{ClientKey}\\color{inherit})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#EE6666;"><span class="mord mathnormal" style="color:#EE6666;">St</span><span class="mord mathnormal" style="color:#EE6666;">ore</span><span class="mord mathnormal" style="color:#EE6666;">d</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#EE6666;">Key</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;color:inherit;">H</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="color:inherit;">s</span><span class="mord mathnormal" style="color:inherit;">h</span><span class="mopen" style="color:inherit;">(</span><span class="mord" style="color:#B8CC44;"><span class="mord mathnormal" style="margin-right:0.01968em;color:#B8CC44;">Cl</span><span class="mord mathnormal" style="color:#B8CC44;">i</span><span class="mord mathnormal" style="color:#B8CC44;">e</span><span class="mord mathnormal" style="color:#B8CC44;">n</span><span class="mord mathnormal" style="color:#B8CC44;">t</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#B8CC44;">Key</span></span><span class="mclose" style="color:inherit;">)</span></span></span></span></p><p>Then the server calculates ClientSignature:</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="orange"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>S</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>H</mi><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy="false">(</mo><mstyle mathcolor="#EE6666"><mrow><mi>S</mi><mi>t</mi><mi>o</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo separator="true">,</mo><mstyle mathcolor="green"><mrow><mi>A</mi><mi>u</mi><mi>t</mi><mi>h</mi><mi>M</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi></mrow><mstyle mathcolor="inherit"><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{orange}{ClientSignature}\\color{inherit} = HMAC(\\color{#EE6666}{StoredKey}\\color{inherit}, \\color{green}{AuthMessage}\\color{inherit})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:orange;"><span class="mord mathnormal" style="margin-right:0.01968em;color:orange;">Cl</span><span class="mord mathnormal" style="color:orange;">i</span><span class="mord mathnormal" style="color:orange;">e</span><span class="mord mathnormal" style="color:orange;">n</span><span class="mord mathnormal" style="margin-right:0.05764em;color:orange;">tS</span><span class="mord mathnormal" style="color:orange;">i</span><span class="mord mathnormal" style="margin-right:0.03588em;color:orange;">g</span><span class="mord mathnormal" style="color:orange;">na</span><span class="mord mathnormal" style="color:orange;">t</span><span class="mord mathnormal" style="color:orange;">u</span><span class="mord mathnormal" style="color:orange;">re</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;color:inherit;">H</span><span class="mord mathnormal" style="margin-right:0.10903em;color:inherit;">M</span><span class="mord mathnormal" style="color:inherit;">A</span><span class="mord mathnormal" style="margin-right:0.07153em;color:inherit;">C</span><span class="mopen" style="color:inherit;">(</span><span class="mord" style="color:#EE6666;"><span class="mord mathnormal" style="color:#EE6666;">St</span><span class="mord mathnormal" style="color:#EE6666;">ore</span><span class="mord mathnormal" style="color:#EE6666;">d</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#EE6666;">Key</span></span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:green;"><span class="mord mathnormal" style="color:green;">A</span><span class="mord mathnormal" style="color:green;">u</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">h</span><span class="mord mathnormal" style="margin-right:0.10903em;color:green;">M</span><span class="mord mathnormal" style="color:green;">ess</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">g</span><span class="mord mathnormal" style="color:green;">e</span></span><span class="mclose" style="color:inherit;">)</span></span></span></span></p><p>Recover ClientKey using received ClientProof:</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#B8CC44"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mstyle mathcolor="#935116"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>P</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>f</mi></mrow><mtext> </mtext><mstyle mathcolor="inherit"><mi>X</mi><mi>O</mi><mi>R</mi><mtext>  </mtext><mstyle mathcolor="orange"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>S</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></mstyle></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{#B8CC44}{ClientKey}\\color{inherit} = \\color{#935116}{ClientProof} \\ \\color{inherit} XOR \\ \\ \\color{orange}{ClientSignature}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#B8CC44;"><span class="mord mathnormal" style="margin-right:0.01968em;color:#B8CC44;">Cl</span><span class="mord mathnormal" style="color:#B8CC44;">i</span><span class="mord mathnormal" style="color:#B8CC44;">e</span><span class="mord mathnormal" style="color:#B8CC44;">n</span><span class="mord mathnormal" style="color:#B8CC44;">t</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#B8CC44;">Key</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#935116;"><span class="mord mathnormal" style="margin-right:0.01968em;color:#935116;">Cl</span><span class="mord mathnormal" style="color:#935116;">i</span><span class="mord mathnormal" style="color:#935116;">e</span><span class="mord mathnormal" style="color:#935116;">n</span><span class="mord mathnormal" style="margin-right:0.13889em;color:#935116;">tP</span><span class="mord mathnormal" style="color:#935116;">roo</span><span class="mord mathnormal" style="margin-right:0.10764em;color:#935116;">f</span></span><span class="mspace" style="color:#935116;"><span style="color:#935116;"> </span></span><span class="mord mathnormal" style="margin-right:0.00773em;color:inherit;">XOR</span><span class="mspace" style="color:inherit;"><span style="color:inherit;"> </span></span><span class="mspace" style="color:inherit;"><span style="color:inherit;"> </span></span><span class="mord" style="color:orange;"><span class="mord mathnormal" style="margin-right:0.01968em;color:orange;">Cl</span><span class="mord mathnormal" style="color:orange;">i</span><span class="mord mathnormal" style="color:orange;">e</span><span class="mord mathnormal" style="color:orange;">n</span><span class="mord mathnormal" style="margin-right:0.05764em;color:orange;">tS</span><span class="mord mathnormal" style="color:orange;">i</span><span class="mord mathnormal" style="margin-right:0.03588em;color:orange;">g</span><span class="mord mathnormal" style="color:orange;">na</span><span class="mord mathnormal" style="color:orange;">t</span><span class="mord mathnormal" style="color:orange;">u</span><span class="mord mathnormal" style="color:orange;">re</span></span></span></span></span></p><p>IF <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#EE6666"><mrow><mi>S</mi><mi>t</mi><mi>o</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mo>=</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mstyle mathcolor="#B8CC44"><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{#EE6666}{StoredKey}\\color{inherit} == Hash(\\color{#B8CC44}{ClientKey}\\color{inherit})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#EE6666;"><span class="mord mathnormal" style="color:#EE6666;">St</span><span class="mord mathnormal" style="color:#EE6666;">ore</span><span class="mord mathnormal" style="color:#EE6666;">d</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#EE6666;">Key</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">==</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;color:inherit;">H</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="color:inherit;">s</span><span class="mord mathnormal" style="color:inherit;">h</span><span class="mopen" style="color:inherit;">(</span><span class="mord" style="color:#B8CC44;"><span class="mord mathnormal" style="margin-right:0.01968em;color:#B8CC44;">Cl</span><span class="mord mathnormal" style="color:#B8CC44;">i</span><span class="mord mathnormal" style="color:#B8CC44;">e</span><span class="mord mathnormal" style="color:#B8CC44;">n</span><span class="mord mathnormal" style="color:#B8CC44;">t</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#B8CC44;">Key</span></span><span class="mclose" style="color:inherit;">)</span></span></span></span> THEN SUCESS.</p></li><li><p>Calculates ServerKey and ServerSignature</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mrow><mi>S</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>H</mi><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy="false">(</mo><mstyle mathcolor="#C3B1E1"><mrow><mi>S</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>P</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi></mrow><mstyle mathcolor="inherit"><mo separator="true">,</mo><mi mathvariant="normal">&quot;</mi><mi>S</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mtext> </mtext><mi>K</mi><mi>e</mi><mi>y</mi><mi mathvariant="normal">&quot;</mi><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{cyan}{ServerKey}\\color{inherit} = HMAC(\\color{#C3B1E1}{SaltedPassword}\\color{inherit}, &quot;Server\\ Key&quot;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord" style="color:cyan;"><span class="mord mathnormal" style="margin-right:0.05764em;color:cyan;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;color:cyan;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;color:cyan;">v</span><span class="mord mathnormal" style="margin-right:0.03588em;color:cyan;">erKey</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;color:inherit;">H</span><span class="mord mathnormal" style="margin-right:0.10903em;color:inherit;">M</span><span class="mord mathnormal" style="color:inherit;">A</span><span class="mord mathnormal" style="margin-right:0.07153em;color:inherit;">C</span><span class="mopen" style="color:inherit;">(</span><span class="mord" style="color:#C3B1E1;"><span class="mord mathnormal" style="margin-right:0.05764em;color:#C3B1E1;">S</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">lt</span><span class="mord mathnormal" style="color:#C3B1E1;">e</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span><span class="mord mathnormal" style="margin-right:0.13889em;color:#C3B1E1;">P</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">ss</span><span class="mord mathnormal" style="margin-right:0.02691em;color:#C3B1E1;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#C3B1E1;">or</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span></span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:inherit;">&quot;</span><span class="mord mathnormal" style="margin-right:0.05764em;color:inherit;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;color:inherit;">v</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">er</span><span class="mspace" style="color:inherit;"><span style="color:inherit;"> </span></span><span class="mord mathnormal" style="margin-right:0.03588em;color:inherit;">Key</span><span class="mord" style="color:inherit;">&quot;</span><span class="mclose" style="color:inherit;">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#DD6F3D"><mi>S</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>S</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mstyle mathcolor="inherit"><mo>=</mo><mi>H</mi><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy="false">(</mo><mstyle mathcolor="cyan"><mrow><mi>S</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo separator="true">,</mo><mstyle mathcolor="green"><mrow><mi>A</mi><mi>u</mi><mi>t</mi><mi>h</mi><mi>M</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi></mrow><mstyle mathcolor="inherit"><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{#DD6F3D}ServerSignature\\color{inherit} = HMAC(\\color{cyan}{ServerKey}\\color{inherit}, \\color{green}{AuthMessage}\\color{inherit})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;color:#DD6F3D;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#DD6F3D;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#DD6F3D;">v</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#DD6F3D;">er</span><span class="mord mathnormal" style="margin-right:0.05764em;color:#DD6F3D;">S</span><span class="mord mathnormal" style="color:#DD6F3D;">i</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#DD6F3D;">g</span><span class="mord mathnormal" style="color:#DD6F3D;">na</span><span class="mord mathnormal" style="color:#DD6F3D;">t</span><span class="mord mathnormal" style="color:#DD6F3D;">u</span><span class="mord mathnormal" style="color:#DD6F3D;">re</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;color:inherit;">H</span><span class="mord mathnormal" style="margin-right:0.10903em;color:inherit;">M</span><span class="mord mathnormal" style="color:inherit;">A</span><span class="mord mathnormal" style="margin-right:0.07153em;color:inherit;">C</span><span class="mopen" style="color:inherit;">(</span><span class="mord" style="color:cyan;"><span class="mord mathnormal" style="margin-right:0.05764em;color:cyan;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;color:cyan;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;color:cyan;">v</span><span class="mord mathnormal" style="margin-right:0.03588em;color:cyan;">erKey</span></span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:green;"><span class="mord mathnormal" style="color:green;">A</span><span class="mord mathnormal" style="color:green;">u</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">h</span><span class="mord mathnormal" style="margin-right:0.10903em;color:green;">M</span><span class="mord mathnormal" style="color:green;">ess</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">g</span><span class="mord mathnormal" style="color:green;">e</span></span><span class="mclose" style="color:inherit;">)</span></span></span></span></p></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>verifier</td><td>Server signature</td></tr></tbody></table><h3 id="_5-client-verify-server-signature" tabindex="-1"><a class="header-anchor" href="#_5-client-verify-server-signature"><span>5. Client verify server signature</span></a></h3><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#C3B1E1"><mrow><mi>S</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>P</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>P</mi><mi>B</mi><mi>K</mi><mi>D</mi><mi>F</mi><mn>2</mn><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi><mo separator="true">,</mo><mi>s</mi><mi>a</mi><mi>l</mi><mi>t</mi><mo separator="true">,</mo><mi>i</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mtext>-</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">)</mo></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{#C3B1E1}{SaltedPassword}\\color{inherit} = PBKDF2(password, salt, iteration\\text{-}count)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord" style="color:#C3B1E1;"><span class="mord mathnormal" style="margin-right:0.05764em;color:#C3B1E1;">S</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">lt</span><span class="mord mathnormal" style="color:#C3B1E1;">e</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span><span class="mord mathnormal" style="margin-right:0.13889em;color:#C3B1E1;">P</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">ss</span><span class="mord mathnormal" style="margin-right:0.02691em;color:#C3B1E1;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#C3B1E1;">or</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;color:inherit;">PB</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">KD</span><span class="mord mathnormal" style="margin-right:0.13889em;color:inherit;">F</span><span class="mord" style="color:inherit;">2</span><span class="mopen" style="color:inherit;">(</span><span class="mord mathnormal" style="color:inherit;">p</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="color:inherit;">ss</span><span class="mord mathnormal" style="margin-right:0.02691em;color:inherit;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">or</span><span class="mord mathnormal" style="color:inherit;">d</span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="color:inherit;">s</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="color:inherit;">lt</span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">er</span><span class="mord mathnormal" style="color:inherit;">a</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mord mathnormal" style="color:inherit;">i</span><span class="mord mathnormal" style="color:inherit;">o</span><span class="mord mathnormal" style="color:inherit;">n</span><span class="mord text" style="color:inherit;"><span class="mord" style="color:inherit;">-</span></span><span class="mord mathnormal" style="color:inherit;">co</span><span class="mord mathnormal" style="color:inherit;">u</span><span class="mord mathnormal" style="color:inherit;">n</span><span class="mord mathnormal" style="color:inherit;">t</span><span class="mclose" style="color:inherit;">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="cyan"><mrow><mi>S</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>H</mi><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy="false">(</mo><mstyle mathcolor="#C3B1E1"><mrow><mi>S</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>P</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi></mrow><mstyle mathcolor="inherit"><mo separator="true">,</mo><mi mathvariant="normal">&quot;</mi><mi>S</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mtext> </mtext><mi>K</mi><mi>e</mi><mi>y</mi><mi mathvariant="normal">&quot;</mi><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{cyan}{ServerKey}\\color{inherit} = HMAC(\\color{#C3B1E1}{SaltedPassword}\\color{inherit}, &quot;Server\\ Key&quot;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord" style="color:cyan;"><span class="mord mathnormal" style="margin-right:0.05764em;color:cyan;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;color:cyan;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;color:cyan;">v</span><span class="mord mathnormal" style="margin-right:0.03588em;color:cyan;">erKey</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;color:inherit;">H</span><span class="mord mathnormal" style="margin-right:0.10903em;color:inherit;">M</span><span class="mord mathnormal" style="color:inherit;">A</span><span class="mord mathnormal" style="margin-right:0.07153em;color:inherit;">C</span><span class="mopen" style="color:inherit;">(</span><span class="mord" style="color:#C3B1E1;"><span class="mord mathnormal" style="margin-right:0.05764em;color:#C3B1E1;">S</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">lt</span><span class="mord mathnormal" style="color:#C3B1E1;">e</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span><span class="mord mathnormal" style="margin-right:0.13889em;color:#C3B1E1;">P</span><span class="mord mathnormal" style="color:#C3B1E1;">a</span><span class="mord mathnormal" style="color:#C3B1E1;">ss</span><span class="mord mathnormal" style="margin-right:0.02691em;color:#C3B1E1;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#C3B1E1;">or</span><span class="mord mathnormal" style="color:#C3B1E1;">d</span></span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:inherit;">&quot;</span><span class="mord mathnormal" style="margin-right:0.05764em;color:inherit;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;color:inherit;">v</span><span class="mord mathnormal" style="margin-right:0.02778em;color:inherit;">er</span><span class="mspace" style="color:inherit;"><span style="color:inherit;"> </span></span><span class="mord mathnormal" style="margin-right:0.03588em;color:inherit;">Key</span><span class="mord" style="color:inherit;">&quot;</span><span class="mclose" style="color:inherit;">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#DD6F3D"><mrow><mi>E</mi><mi>x</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>S</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>S</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow><mstyle mathcolor="inherit"><mo>=</mo><mi>H</mi><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy="false">(</mo><mstyle mathcolor="cyan"><mrow><mi>S</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow><mstyle mathcolor="inherit"><mo separator="true">,</mo><mstyle mathcolor="green"><mrow><mi>A</mi><mi>u</mi><mi>t</mi><mi>h</mi><mi>M</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi></mrow><mstyle mathcolor="inherit"><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\color{#DD6F3D}{ExpectedServerSignature}\\color{inherit} = HMAC(\\color{cyan}{ServerKey}\\color{inherit}, \\color{green}{AuthMessage}\\color{inherit})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#DD6F3D;"><span class="mord mathnormal" style="margin-right:0.05764em;color:#DD6F3D;">E</span><span class="mord mathnormal" style="color:#DD6F3D;">x</span><span class="mord mathnormal" style="color:#DD6F3D;">p</span><span class="mord mathnormal" style="color:#DD6F3D;">ec</span><span class="mord mathnormal" style="color:#DD6F3D;">t</span><span class="mord mathnormal" style="color:#DD6F3D;">e</span><span class="mord mathnormal" style="color:#DD6F3D;">d</span><span class="mord mathnormal" style="margin-right:0.05764em;color:#DD6F3D;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#DD6F3D;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#DD6F3D;">v</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#DD6F3D;">er</span><span class="mord mathnormal" style="margin-right:0.05764em;color:#DD6F3D;">S</span><span class="mord mathnormal" style="color:#DD6F3D;">i</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#DD6F3D;">g</span><span class="mord mathnormal" style="color:#DD6F3D;">na</span><span class="mord mathnormal" style="color:#DD6F3D;">t</span><span class="mord mathnormal" style="color:#DD6F3D;">u</span><span class="mord mathnormal" style="color:#DD6F3D;">re</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:inherit;">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;color:inherit;">H</span><span class="mord mathnormal" style="margin-right:0.10903em;color:inherit;">M</span><span class="mord mathnormal" style="color:inherit;">A</span><span class="mord mathnormal" style="margin-right:0.07153em;color:inherit;">C</span><span class="mopen" style="color:inherit;">(</span><span class="mord" style="color:cyan;"><span class="mord mathnormal" style="margin-right:0.05764em;color:cyan;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;color:cyan;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;color:cyan;">v</span><span class="mord mathnormal" style="margin-right:0.03588em;color:cyan;">erKey</span></span><span class="mpunct" style="color:inherit;">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="color:green;"><span class="mord mathnormal" style="color:green;">A</span><span class="mord mathnormal" style="color:green;">u</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">h</span><span class="mord mathnormal" style="margin-right:0.10903em;color:green;">M</span><span class="mord mathnormal" style="color:green;">ess</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">g</span><span class="mord mathnormal" style="color:green;">e</span></span><span class="mclose" style="color:inherit;">)</span></span></span></span></p><p>IF <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#DD6F3D"><mrow><mi>S</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>S</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow><mo>=</mo><mo>=</mo><mi>E</mi><mi>x</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>S</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>S</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi></mstyle></mrow><annotation encoding="application/x-tex">\\color{#DD6F3D}{ServerSignature} == ExpectedServerSignature</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord" style="color:#DD6F3D;"><span class="mord mathnormal" style="margin-right:0.05764em;color:#DD6F3D;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#DD6F3D;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#DD6F3D;">v</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#DD6F3D;">er</span><span class="mord mathnormal" style="margin-right:0.05764em;color:#DD6F3D;">S</span><span class="mord mathnormal" style="color:#DD6F3D;">i</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#DD6F3D;">g</span><span class="mord mathnormal" style="color:#DD6F3D;">na</span><span class="mord mathnormal" style="color:#DD6F3D;">t</span><span class="mord mathnormal" style="color:#DD6F3D;">u</span><span class="mord mathnormal" style="color:#DD6F3D;">re</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:#DD6F3D;">==</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;color:#DD6F3D;">E</span><span class="mord mathnormal" style="color:#DD6F3D;">x</span><span class="mord mathnormal" style="color:#DD6F3D;">p</span><span class="mord mathnormal" style="color:#DD6F3D;">ec</span><span class="mord mathnormal" style="color:#DD6F3D;">t</span><span class="mord mathnormal" style="color:#DD6F3D;">e</span><span class="mord mathnormal" style="color:#DD6F3D;">d</span><span class="mord mathnormal" style="margin-right:0.05764em;color:#DD6F3D;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#DD6F3D;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#DD6F3D;">v</span><span class="mord mathnormal" style="margin-right:0.02778em;color:#DD6F3D;">er</span><span class="mord mathnormal" style="margin-right:0.05764em;color:#DD6F3D;">S</span><span class="mord mathnormal" style="color:#DD6F3D;">i</span><span class="mord mathnormal" style="margin-right:0.03588em;color:#DD6F3D;">g</span><span class="mord mathnormal" style="color:#DD6F3D;">na</span><span class="mord mathnormal" style="color:#DD6F3D;">t</span><span class="mord mathnormal" style="color:#DD6F3D;">u</span><span class="mord mathnormal" style="color:#DD6F3D;">re</span></span></span></span> THEN SUCESS</p>',20))])}const y=n(e,[["render",c]]),d=JSON.parse('{"path":"/article/k5kh9q8g/","title":"SCRAM","lang":"en-US","frontmatter":{"title":"SCRAM","createTime":"2025/07/22 14:56:24","permalink":"/article/k5kh9q8g/","tags":["SCRAM"]},"readingTime":{"minutes":1.64,"words":493},"git":{"createdTime":1753168388000},"filePathRelative":"working/scram.md","headers":[],"categoryList":[{"id":"c327b4","sort":10000,"name":"working"}]}');export{y as comp,d as data};
